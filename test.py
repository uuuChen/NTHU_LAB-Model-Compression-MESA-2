import numpy as npfrom sklearn.cluster import KMeansori_weights = np.array([[0, 0, 0], [4, 5, 6], [7, 8, 9]])percentile = np.array([[0, 0, 0], [4, 5, 6], [7, 8, 9]])nonzero_flat_weights = ori_weights[ori_weights != 0].reshape(-1, 1)nonzero_indice = np.where(ori_weights != 0)zero_indice = np.where(ori_weights == 0)space = np.linspace(    np.min(nonzero_flat_weights), np.max(nonzero_flat_weights), num=2).reshape(-1, 1)kmeans = KMeans(n_clusters=len(space), init=space, n_init=1, precompute_distances=True, algorithm="full")kmeans.fit(nonzero_flat_weights)# reconstruct quantized weights and set model.paramquan_weights = np.zeros(ori_weights.shape)quan_weights[nonzero_indice] = kmeans.cluster_centers_[kmeans.labels_].reshape(-1)# reconstruct quantized labelsquan_labels = np.zeros(ori_weights.shape)quan_labels[nonzero_indice] = kmeans.labels_print(quan_weights)print(quan_labels)